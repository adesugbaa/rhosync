<h1>Document [<%= params[:dbkey]%>]</h1>
<%=show_errors%>
<div class='panel'>
	<a href='<%= @back_href%>' class='nav_button'>Back</a>
</div>
<h2>Upload document</h2>
<div class='panel'>
	<form action='<%=url("doc/upload?#{@back_params}")%>' method='post' enctype="multipart/form-data">
		<input type='hidden' name='doc' value='<%= "#{CGI.escape(params[:dbkey])}"%>'/>
		<table>
			<%if @is_string%>
				<tr>
					<td>Token string:</td>	
					<td><input type='text' name='string' value=''/></td>
				</tr>
			<%else%>
				<tr>
					<td>Data (hash of hashes in json):</td>	
					<td><input type='file' name='file' value=''/></td>
				</tr>
			<%end%>	
			<tr>
				<td></td>	
				<td><input type='submit' value='Submit'/></td>
			</tr>
		</table>		
	</form>	
</div>
<h2>Data</h2>
<div class='panel'>
	<%if @data.size > 0%>
		<div class='panel'>
			<a href='<%=url("doc/clear?#{@back_params}&dbkey=#{CGI.escape(params[:dbkey])}")%>' class='nav_button'>Clear document</a>
		</div>
		<%if @is_string%>
			<p>[<%=@data%>]</p>
		<%else%>
			<table>
				<%@data.each do |obj_id,obj|%>
					<tr>
						<td colspan=3>[<%=obj_id%>]</td>
					</tr>	
					<%obj.each do |attrib,value|%>
						<tr>
							<td></td>
							<td><%=attrib%>:</td>
							<td><%=value%></td>
						</tr>
					<%end%>		
				<%end%>
			</table>
		<%end%>	
	<%else%>
		<p>Document is empty</p>
	<%end%>
</div>